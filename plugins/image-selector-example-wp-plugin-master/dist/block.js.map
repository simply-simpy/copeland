{"version":3,"sources":["edit.js","block.js"],"names":["__","wp","i18n","element","Component","Fragment","editor","InspectorControls","InnerBlocks","MediaUpload","MediaUploadCheck","components","PanelBody","Button","ResponsiveWrapper","Spinner","compose","withSelect","data","ALLOWED_MEDIA_TYPES","ImageSelectorEdit","props","attributes","setAttributes","bgImage","className","bgImageId","instructions","styles","source_url","backgroundImage","onUpdateImage","image","id","open","media_details","width","height","undefined","select","getMedia","registerBlockType","blocks","title","icon","category","keywords","supports","align","type","edit","save"],"mappings":"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","file":"block.js","sourceRoot":"../assets/blocks/image-selector-example","sourcesContent":["/**\n * ImageSelectorEdit component.\n *\n * This is an adapted copy of the PostFeaturedImage component.\n * Source: https://github.com/WordPress/gutenberg/blob/master/packages/editor/src/components/post-featured-image/index.js\n */\n\n// Load dependencies\nconst { __ } = wp.i18n;\nconst { Component, Fragment } = wp.element;\nconst { InspectorControls, InnerBlocks, MediaUpload, MediaUploadCheck } = wp.editor;\nconst { PanelBody, Button, ResponsiveWrapper, Spinner } = wp.components;\nconst { compose } = wp.compose;\nconst { withSelect } = wp.data;\n\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nclass ImageSelectorEdit extends Component {\n\trender() {\n\t\tconst { attributes, setAttributes, bgImage, className } = this.props;\n\t\tconst { bgImageId } = attributes;\n\t\tconst instructions = <p>{ __( 'To edit the background image, you need permission to upload media.', 'image-selector-example' ) }</p>;\n\n\t\tlet styles = {};\n\t\tif ( bgImage && bgImage.source_url ) {\n\t\t\tstyles = { backgroundImage: `url(${ bgImage.source_url })` };\n\t\t}\n\n\t\tconst onUpdateImage = ( image ) => {\n\t\t\tsetAttributes( {\n\t\t\t\tbgImageId: image.id,\n\t\t\t} );\n\t\t};\n\n\t\tconst onRemoveImage = () => {\n\t\t\tsetAttributes( {\n\t\t\t\tbgImageId: undefined,\n\t\t\t} );\n\t\t};\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody\n\t\t\t\t\t\ttitle={ __( 'Background settings', 'image-selector-example' ) }\n\t\t\t\t\t\tinitialOpen={ true }\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"wp-block-image-selector-example-image\">\n\t\t\t\t\t\t\t<MediaUploadCheck fallback={ instructions }>\n\t\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\t\ttitle={ __( 'Background image', 'image-selector-example' ) }\n\t\t\t\t\t\t\t\t\tonSelect={ onUpdateImage }\n\t\t\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\t\t\tvalue={ bgImageId }\n\t\t\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tclassName={ ! bgImageId ? 'editor-post-featured-image__toggle' : 'editor-post-featured-image__preview' }\n\t\t\t\t\t\t\t\t\t\t\tonClick={ open }>\n\t\t\t\t\t\t\t\t\t\t\t{ ! bgImageId && ( __( 'Set background image', 'image-selector-example' ) ) }\n\t\t\t\t\t\t\t\t\t\t\t{ !! bgImageId && ! bgImage && <Spinner /> }\n\t\t\t\t\t\t\t\t\t\t\t{ !! bgImageId && bgImage &&\n\t\t\t\t\t\t\t\t\t\t\t\t<ResponsiveWrapper\n\t\t\t\t\t\t\t\t\t\t\t\t\tnaturalWidth={ bgImage.media_details.width }\n\t\t\t\t\t\t\t\t\t\t\t\t\tnaturalHeight={ bgImage.media_details.height }\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img src={ bgImage.source_url } alt={ __( 'Background image', 'image-selector-example' ) } />\n\t\t\t\t\t\t\t\t\t\t\t\t</ResponsiveWrapper>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</MediaUploadCheck>\n\t\t\t\t\t\t\t{ !! bgImageId && bgImage &&\n\t\t\t\t\t\t\t\t<MediaUploadCheck>\n\t\t\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\t\t\ttitle={ __( 'Background image', 'image-selector-example' ) }\n\t\t\t\t\t\t\t\t\t\tonSelect={ onUpdateImage }\n\t\t\t\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\t\t\t\tvalue={ bgImageId }\n\t\t\t\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t\t\t\t<Button onClick={ open } isDefault isLarge>\n\t\t\t\t\t\t\t\t\t\t\t\t{ __( 'Replace background image', 'image-selector-example' ) }\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</MediaUploadCheck>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{ !! bgImageId &&\n\t\t\t\t\t\t\t\t<MediaUploadCheck>\n\t\t\t\t\t\t\t\t\t<Button onClick={ onRemoveImage } isLink isDestructive>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Remove background image', 'image-selector-example' ) }\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</MediaUploadCheck>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t</InspectorControls>\n\t\t\t\t<div\n\t\t\t\t\tclassName={ className }\n\t\t\t\t\tstyle={ styles }\n\t\t\t\t>\n\t\t\t\t\t<InnerBlocks />\n\t\t\t\t</div>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select, props ) => {\n\t\tconst { getMedia } = select( 'core' );\n\t\tconst { bgImageId } = props.attributes;\n\n\t\treturn {\n\t\t\tbgImage: bgImageId ? getMedia( bgImageId ) : null,\n\t\t};\n\t} ),\n)( ImageSelectorEdit );\n","/**\n * BLOCK: image-selector-example/image-selector\n */\n// Import styles\nimport './style.scss';\n\nimport edit from './edit';\n\nconst { __ } = wp.i18n;\nconst { registerBlockType } = wp.blocks;\nconst { InnerBlocks } = wp.editor;\n\nregisterBlockType( 'image-selector-example/image-selector', {\n\ttitle: __( 'Image Selector Example', 'image-selector-example' ),\n\ticon: 'format-image',\n\tcategory: 'common',\n\tkeywords: [\n\t\t__( 'Image Selector', 'image-selector-example' ),\n\t],\n\n\tsupports: {\n\t\talign: [ 'full' ],\n\t},\n\n\tattributes: {\n\t\tbgImageId: {\n\t\t\ttype: 'number',\n\t\t},\n\t},\n\n\tedit,\n\n\tsave() {\n\t\treturn (\n\t\t\t<InnerBlocks.Content />\n\t\t);\n\t},\n} );\n"]}